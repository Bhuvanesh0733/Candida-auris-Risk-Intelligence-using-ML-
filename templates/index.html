<!DOCTYPE html>
<html lang="en">

<head>
    <title>Candida auris Risk Intelligence</title>

    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@600&display=swap" rel="stylesheet">

    <style>
         :root {
            --bg: #020617;
            --blue: #38bdf8;
            --green: #22c55e;
            --yellow: #facc15;
            --red: #ef4444;
            --text: #e5e7eb;
            --dim: #9ca3af;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            background: radial-gradient(circle at top, #0f172a, #020617);
            font-family: Inter, sans-serif;
            color: var(--text);
        }
        
        .app {
            display: grid;
            grid-template-columns: 420px 1fr;
            min-height: 100vh;
        }
        /* ================= LEFT PANEL ================= */
        
        .left {
            padding: 28px;
            background: linear-gradient(180deg, #0b1220, #020617);
            border-right: 1px solid rgba(255, 255, 255, .08);
            overflow-y: auto;
        }
        
        .title {
            font-family: Orbitron, sans-serif;
            font-size: 26px;
        }
        
        .subtitle {
            font-size: 13px;
            color: var(--dim);
            margin-bottom: 22px;
        }
        
        h3 {
            font-size: 12px;
            color: var(--dim);
            margin: 22px 0 10px;
            letter-spacing: .8px;
        }
        
        .field-label {
            font-size: 12px;
            color: var(--dim);
            margin-bottom: 4px;
        }
        
        input,
        select {
            width: 100%;
            padding: 9px;
            margin-bottom: 12px;
            background: #020617;
            border: 1px solid #1f2937;
            border-radius: 6px;
            color: var(--text);
        }
        
        button {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: none;
            font-weight: 700;
            background: linear-gradient(90deg, #38bdf8, #6366f1);
            cursor: pointer;
            color: #020617;
            margin-top: 10px;
        }
        /* ================= RIGHT PANEL ================= */
        
        .right {
            padding: 28px;
            display: grid;
            grid-template-rows: auto 1fr;
            gap: 22px;
        }
        
        .card {
            background: linear-gradient(145deg, #0f172a, #020617);
            border-radius: 16px;
            padding: 22px;
            border: 1px solid rgba(255, 255, 255, .08);
            box-shadow: 0 0 40px rgba(0, 0, 0, .6);
        }
        
        .dpi {
            font-family: JetBrains Mono, monospace;
            font-size: 50px;
            color: var(--blue);
        }
        
        .label {
            font-size: 14px;
            color: var(--dim);
        }
        
        .grid {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 22px;
        }
        /* ================= RISK CIRCLE ================= */
        
        .circle {
            width: 240px;
            height: 240px;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            margin: auto;
            border: 1px solid rgba(255, 255, 255, .1);
        }
        
        .core {
            position: absolute;
            inset: -40%;
            border-radius: 50%;
            filter: blur(18px);
            animation: spin linear infinite;
        }
        
        .LOW .core {
            background: conic-gradient(from 0deg, var(--green), transparent, var(--green));
            animation-duration: 14s;
        }
        
        .MODERATE .core {
            background: conic-gradient(from 0deg, var(--yellow), transparent, var(--yellow));
            animation-duration: 6s;
        }
        
        .HIGH .core {
            background: conic-gradient(from 0deg, var(--red), #ff7a7a, var(--red));
            animation-duration: 2.5s;
        }
        
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        .center {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
            z-index: 2;
        }
        /* ================= BADGES ================= */
        
        .badge {
            display: inline-flex;
            padding: 6px 14px;
            border-radius: 999px;
            font-weight: 700;
            font-size: 14px;
        }
        
        .LOW.badge {
            background: var(--green);
            color: #022c22;
        }
        
        .MODERATE.badge {
            background: var(--yellow);
            color: #422006;
        }
        
        .HIGH.badge {
            background: var(--red);
            color: white;
        }
        /* ================= EXPLANATION BOXES ================= */
        
        .brief {
            display: grid;
            gap: 14px;
        }
        
        .box {
            padding: 16px;
            border-radius: 12px;
            background: rgba(255, 255, 255, .04);
            border-left: 4px solid;
            font-size: 15px;
            line-height: 1.6;
        }
        
        .status {
            border-color: var(--blue);
        }
        
        .drivers {
            border-color: var(--yellow);
        }
        
        .actions {
            border-color: var(--red);
        }
    </style>
</head>

<body>

    <div class="app">

        <!-- ================= LEFT ================= -->

        <div class="left">
            <div class="title">üß¨ Candida auris</div>
            <div class="subtitle">Risk Intelligence Dashboard</div>

            <h3>ICU PARAMETERS</h3>

            <div class="field-label">Œõ ‚Äì ICU Admission Rate</div>
            <input name="Lambda" form="f">

            <div class="field-label">Œ≤‚ÇÅ ‚Äì HCW ‚Üí Patient Transmission</div>
            <input name="beta1" form="f">

            <div class="field-label">Œ≤‚ÇÇ ‚Äì Patient ‚Üí HCW Transmission</div>
            <input name="beta2" form="f">

            <div class="field-label">d‚ÇÅ ‚Äì Patient Discharge / Death Rate</div>
            <input name="d1" form="f">

            <div class="field-label">d‚ÇÇ ‚Äì Colonization Clearance Rate</div>
            <input name="d2" form="f">

            <div class="field-label">Œª ‚Äì HCW Decontamination Rate</div>
            <input name="lambda" form="f">

            <div class="field-label">1/œÉ ‚Äì Colonization Duration</div>
            <input name="1_over_sigma" form="f">

            <div class="field-label">œÜ ‚Äì Colonized ‚Üí Infected Progression</div>
            <input name="phi" form="f">

            <div class="field-label">Œº ‚Äì Environmental Contamination</div>
            <input name="mu" form="f">

            <h3>INDIVIDUAL EXPOSURE</h3>

            <div class="field-label">ICU Stay Duration (days)</div>
            <input name="icu_days" form="f">

            <div class="field-label">HCW Contact Frequency</div>
            <select name="hcw_contact" form="f">
            <option value="low">Low HCW Contact</option>
            <option value="medium">Medium HCW Contact</option>
            <option value="high">High HCW Contact</option>
        </select>

            <div class="field-label">Immune Status</div>
            <select name="immune_status" form="f">
            <option value="normal">Normal Immunity</option>
            <option value="immunocompromised">Immunocompromised</option>
        </select>

            <form id="f">
                <button>üöÄ Run Risk Analysis</button>
            </form>
        </div>

        <!-- ================= RIGHT ================= -->

        <div class="right">

            <div class="card">
                <div class="label">Predicted Infection Growth</div>
                <div id="dpi" class="dpi">‚Äî</div>
                <div class="label">dPI / dt</div>
            </div>

            <div class="card grid">

                <div>
                    <div id="circle" class="circle">
                        <div class="core"></div>
                        <div id="center" class="center">‚Äî</div>
                    </div>

                    <div style="margin-top:16px">
                        <div class="label">ICU Risk</div>
                        <div id="icu" class="badge">‚Äî</div>

                        <div class="label" style="margin-top:8px">Individual Risk</div>
                        <div id="ind" class="badge">‚Äî</div>
                    </div>
                </div>

                <div class="brief">
                    <div id="status" class="box status">Waiting for analysis‚Ä¶</div>
                    <div id="drivers" class="box drivers"></div>
                    <div id="actions" class="box actions"></div>
                </div>

            </div>
        </div>
    </div>

    <script>
        document.getElementById("f").addEventListener("submit", async function(e) {
            e.preventDefault();

            const dpi = document.getElementById("dpi");
            const icu = document.getElementById("icu");
            const ind = document.getElementById("ind");
            const circle = document.getElementById("circle");
            const center = document.getElementById("center");
            const status = document.getElementById("status");
            const drivers = document.getElementById("drivers");
            const actions = document.getElementById("actions");

            status.innerHTML = "‚è≥ <b>Analyzing risk profile...</b>";
            drivers.innerHTML = "";
            actions.innerHTML = "";

            const res = await fetch("/predict", {
                method: "POST",
                body: new FormData(this)
            });

            const d = await res.json();

            dpi.innerText = d.dPI_dt;
            icu.innerText = d.icu_risk;
            ind.innerText = d.individual_risk;

            icu.className = "badge " + d.icu_risk;
            ind.className = "badge " + d.individual_risk;
            circle.className = "circle " + d.individual_risk;

            center.innerText =
                d.individual_risk === "HIGH" ? "üö® HIGH" :
                d.individual_risk === "MODERATE" ? "‚ö†Ô∏è MODERATE" :
                "‚úÖ LOW";

            status.innerHTML =
                "üìä <b>Status Summary</b><br>" +
                "ICU-level infection pressure is <b>" + d.icu_risk + "</b>.<br>" +
                "Individual exposure risk is <b>" + d.individual_risk + "</b>.";

            drivers.innerHTML =
                "üß† <b>Primary Drivers</b><br>" +
                "Transmission intensity, exposure duration, and HCW contact.";

            actions.innerHTML =
                d.individual_risk === "HIGH" ?
                "üö® <b>Recommended Actions</b><br>Immediate isolation, strict hygiene, environmental disinfection, and active surveillance." :
                d.individual_risk === "MODERATE" ?
                "‚ö†Ô∏è <b>Recommended Actions</b><br>Enhanced monitoring and reinforcement of precautions." :
                "‚úÖ <b>Recommended Actions</b><br>Maintain current infection control measures.";
        });
    </script>

</body>

</html>